$circle-size: 120px;
$circle-background: var(--fd-color-background-2, #fff);
$transition-length: 0.7s;

@mixin circle-shape($size) {
  border-radius: 50%;
  width: $size;
  height: $size;
}

@mixin flex-center() {
  display: flex;
  align-items: center;
  justify-content: center;
}

@mixin circle-progress($circle-color) {
  @include circle-shape($circle-size);
  @include flex-center();
  background-color: $circle-background;
  position: relative;
  $circle-color: red !default;

  .progress-bar {
    @include circle-shape($circle-size);
    position: absolute;
    background-color: $circle-color;
    z-index: 5;

    %mask {
      @include circle-shape($circle-size);
      position: absolute;
      background-color: $circle-background;
      transition: transform $transition-length;
      clip: rect(0px, $circle-size/2, $circle-size, 0px);
      transform: rotate(0.5turn);
    }
    .mask--dynamic {
      @extend %mask;
      z-index: 5;

      @for $i from 0 through 50 {
        // it is a mask for the left half of the circle
        &.fill--#{$i} {
          transform: rotate(calc(#{$i} / -50 * 0.5turn));
        }
      }

      @for $i from 51 through 100 {
        // it becomes the right half of the circle
        &.fill--#{$i} {
          background-color: $circle-color;
          transform: rotate(calc((100 - #{$i} / 50) * 0.5turn + 0.5turn));
        }
      }
    }
    .mask--permanent {
      @extend %mask;
      background-color: $circle-background;
    }
  }

  .inner-area {
    @include circle-shape($circle-size/1.4);
    @include flex-center();
    background-color: $circle-background;
    position: absolute;
    z-index: 8;
    color: var(--fd-color-text-3);
    .percentage {
      @include circle-shape($circle-size/1.6);
      @include flex-center();
      border: 1px solid var(--fd-color-text-3);
      font-size: $circle-size/5;
    }
  }
}

$colors: (
  'purple': var(--fd-color-accent-4),
  'green': var(--fd-color-accent-8),
  'blue': var(--fd-color-accent-6),
  'teal': teal,
);

@each $name, $value in $colors {
  .circle-progress--#{$name} {
    @include circle-progress($value) /* Any other rules which use $color here */;
  }
}
